---
title: "W8_Task_Idaho_Water_Systems"
author: "Daniel Van Gorkum"
date: "`r format(Sys.Date(), '%B %d, %Y')`"
format: html
editor: visual
execute:
  echo: true
  warning: false
  message: false
  keep-md: true
---

```{r}
library(sf)
library(tidyverse)
library(ggrepel)

# Idaho state shape
idaho <- st_read("Downloads/shp/County-AK-HI-Moved-USA-Map.shp")

# Water bodies
water <- st_read("Downloads/water/hyd250.shp")

# Wells
wells <- st_read("Downloads/Wells/Wells.shp")

# Dams
dams <- st_read("Downloads/Idaho_Dams/Dam_Safety.shp")

```

```{r}
# Wells producing more than 5000 gallons
wells_filtered <- wells %>% filter(Production > 5000)

# Dams with surface area > 50 acres
dams_filtered <- dams %>% filter(SurfaceAre > 50)

# Only Snake River and Henrys Fork
rivers_filtered <- water %>% filter(FEAT_NAME %in% c("Snake River", "Henrys Fork"))

```

```{r}
target_crs <- 5070  # Albers Conical Equal Area for the US

idaho <- st_transform(idaho, crs = target_crs)
wells_filtered <- st_transform(wells_filtered, crs = target_crs)
dams_filtered <- st_transform(dams_filtered, crs = target_crs)
rivers_filtered <- st_transform(rivers_filtered, crs = target_crs)

```

```{r}
idaho_map <- ggplot() +
  geom_sf(data = idaho, fill = NA, color = "black") +
  geom_sf(data = rivers_filtered, color = "blue", size = 1) +
  geom_sf(data = dams_filtered, fill = "red", shape = 21, size = 3) +
  geom_sf(data = wells_filtered, color = "darkgreen", size = 2) +
  theme_minimal() +
  labs(
    title = "Key Water System Features of Idaho",
    subtitle = "Filtered Wells, Large Dams, and Selected Rivers",
    caption = "Data: Provided shapefiles"
  )

idaho_map

ggsave("idaho_water_map.png", idaho_map, width = 15, height = 10, dpi = 300)

```

---
title: "W10_Case_Study"
author: "Daniel Van Gorkum"
date: "`r format(Sys.Date(), '%B %d, %Y')`"
format: html
editor: visual
execute:
  echo: true
  warning: false
  message: false
  keep-md: true
---

## Load

```{r}
library(tidyverse)
library(stringr)

# Load scripture dataset
scriptures <- read_csv("~/Downloads/lds-scriptures.csv")

# Load Savior names dataset
savior_names <- read_rds("https://byuistats.github.io/M335/data/BoM_SaviorNames.rds")

glimpse(scriptures)
glimpse(savior_names)
```

```{r}
# Filter for Book of Mormon

bom <- scriptures %>%
filter(volume_title == "Book of Mormon")

# Collapse all verses into a single string

full_bom_text <- bom$scripture_text %>% paste(collapse = " ")

```

```{r}
savior_pattern <- savior_names$name %>%
  str_replace_all("([\\^$.|?*+()\\[\\]])", "\\\\\\1") %>%
  paste(collapse = "|")

```

```{r}
# Split the text on every Savior name

segments <- str_split(full_bom_text, regex(savior_pattern, ignore_case = TRUE))[[1]]

# Count words in each segment

words_between <- str_count(segments, boundary("word"))

# Remove the first segment (text before first Savior mention)

words_between <- words_between[-1]

# Put into a tibble for plotting

dist_df <- tibble(words_between = words_between)


```

```{r}
ggplot(dist_df, aes(x = words_between)) +
geom_histogram(bins = 60, fill = "steelblue", color = "white") +
labs(
title = "Distribution of Words Between Savior Mentions in the Book of Mormon",
x = "Words Between Savior Names",
y = "Number of Segments"
) +
theme_minimal()


```

```{r}
mean(dist_df$words_between)

```

The plot tells me that the distribution is heavily right skewed and that the majority of distance of words between the saviors name is between 20 and 30 and many being basically back to back or within 10 words. This tells me that there might be some chapters in the Book of Mormon that mention the Lords name many times, with sometimes multiple times in a single verse, and maybe some chapters in the book the (like the war chapters) that might not mention His name as much and be the reason for the skewness in the distribution chart.
